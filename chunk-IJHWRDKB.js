import{b as ce,c as de,d as me,g as pe,h as ue,i as _e,j as ge}from"./chunk-RUSD7P4Y.js";import"./chunk-J6VSZILJ.js";import{a as oe,l as se,n as le}from"./chunk-4JEEGTY5.js";import"./chunk-4HF4CYB4.js";import{b as ne,c as re}from"./chunk-BJ7UQRZ4.js";import{b as G,d as H,g as U,j as Y,l as Z,m as $,n as ee,p as te,q as ie,s as ae}from"./chunk-BFCD6XJQ.js";import"./chunk-4YRY4IP2.js";import{e as X,g as J,l as K}from"./chunk-JY4AAIVW.js";import{$ as x,A as m,B as p,Ca as g,Da as D,Ea as W,Ia as k,Ja as O,N as r,O as f,W as C,Y as l,Ya as N,Za as R,_a as P,ba as o,bb as z,ca as s,da as y,e as E,ha as w,ia as v,ja as c,nb as Q,oa as j,r as A,sb as B,ta as q,ua as _,v as L,va as T,w as V,wa as F,xa as I,ya as M,za as S}from"./chunk-VUSRYWWQ.js";var b=()=>({width:"100%"}),he=i=>({"button-flash":i}),we=(i,d)=>({"border-top-1 surface-border":i,"item-cancel":d});function Ie(i,d){if(i&1&&(o(0,"div",2)(1,"div",24),_(2),s(),o(3,"div",25),_(4),k(5,"currency"),s()()),i&2){let e=d.$implicit;r(2),T(e.name),r(2),T(O(5,2,e.price))}}function Me(i,d){if(i&1){let e=w();o(0,"div",18)(1,"div",19)(2,"p-autoComplete",20),S("ngModelChange",function(t){m(e);let a=c();return M(a.selectedItem,t)||(a.selectedItem=t),p(t)}),v("onFocus",function(t){m(e);let a=c();return p(a.focusSearchMeal(t))})("completeMethod",function(t){m(e);let a=c();return p(a.searchMeal(t))})("onSelect",function(t){m(e);let a=c();return p(a.completeSelectMeal(t))}),C(3,Ie,6,4,"ng-template",21),s()(),o(4,"div",22)(5,"p-inputNumber",23),S("ngModelChange",function(t){m(e);let a=c();return M(a.order.quantity,t)||(a.order.quantity=t),p(t)}),s()()()}if(i&2){let e=c();r(2),x(g(14,b)),l("inputStyle",g(15,b)),I("ngModel",e.selectedItem),l("suggestions",e.suggestionsMeal)("dropdown",!0),r(3),x(g(16,b)),l("inputStyle",g(17,b)),I("ngModel",e.order.quantity),l("showButtons",!0)("step",1)("min",1)("max",100)}}function Se(i,d){if(i&1){let e=w();o(0,"div",18)(1,"div",19)(2,"textarea",26),S("ngModelChange",function(t){m(e);let a=c();return M(a.order.aditional,t)||(a.order.aditional=t),p(t)}),_(3,"                    "),s()(),o(4,"div",22)(5,"button",27),v("click",function(){m(e);let t=c();return p(t.addOrder())}),s()()()}if(i&2){let e=c();r(2),x(g(6,b)),l("autoResize",!0),I("ngModel",e.order.aditional),r(3),x(g(7,b))}}function Te(i,d){i&1&&(o(0,"div",29),y(1,"p-button",33),s()),i&2&&(r(),x(g(3,b)),l("raised",!0))}function Ae(i,d){if(i&1){let e=w();o(0,"div",18),C(1,Te,2,4,"div",28),o(2,"div",29)(3,"p-button",30),v("click",function(){m(e);let t=c();return p(t.requestAttendace())}),s()(),o(4,"div",31)(5,"p-button",32),v("click",function(){m(e);let t=c();return p(t.requestCheck())}),s()()()}if(i&2){let e=c();r(),l("ngIf",!1),r(2),x(g(9,b)),l("raised",!0)("ngClass",D(10,he,e.table==null?null:e.table.isRequestAttendace)),r(2),x(g(12,b)),l("raised",!0)("ngClass",D(13,he,e.table==null?null:e.table.isRequestCheck))}}function Ve(i,d){i&1&&y(0,"img",50)}function ke(i,d){i&1&&y(0,"img",51)}function Oe(i,d){i&1&&y(0,"img",52)}function Ee(i,d){i&1&&y(0,"img",53)}function qe(i,d){i&1&&y(0,"img",54)}function Fe(i,d){if(i&1){let e=w();o(0,"div",48)(1,"p-button",55),v("onClick",function(t){m(e);let a=c().$implicit,h=c(2);return p(h.changeStatusOrder(t,a))}),s()()}if(i&2){let e=c().$implicit;r(),l("disabled",e.statusOrderId!=3)}}function De(i,d){if(i&1){let e=w();o(0,"div",48)(1,"p-button",56),v("onClick",function(){m(e);let t=c().$implicit,a=c(2);return p(a.confirmCancel(t))}),s()()}if(i&2){let e=c().$implicit;r(),l("disabled",e.isCancel||e.statusOrderId>=3)}}function Be(i,d){if(i&1&&(o(0,"div",36)(1,"div",41)(2,"div",25),C(3,Ve,1,0,"img",42)(4,ke,1,0,"img",43)(5,Oe,1,0,"img",44)(6,Ee,1,0,"img",45)(7,qe,1,0,"img",46),s(),o(8,"div",24)(9,"div",47),_(10),s()(),o(11,"div",48)(12,"div",47),_(13),k(14,"currency"),s()(),C(15,Fe,2,1,"div",49)(16,De,2,1,"div",49),s()()),i&2){let e=d.$implicit,n=d.first,t=c(2);r(),l("ngClass",W(12,we,!n,e.isCancel)),r(2),l("ngIf",e.isCancel),r(),l("ngIf",e.statusOrderId==1&&!e.isCancel),r(),l("ngIf",e.statusOrderId==2&&!e.isCancel),r(),l("ngIf",e.statusOrderId==3&&!e.isCancel),r(),l("ngIf",e.statusOrderId==4&&!e.isCancel),r(3),T(e.quantity+" "+(e.meal==null?null:e.meal.name)),r(3),T(O(14,10,(e.meal==null?null:e.meal.price)*e.quantity)),r(2),l("ngIf",t.isLogin),r(),l("ngIf",t.isLogin)}}function Le(i,d){if(i&1&&(o(0,"div",34),C(1,Be,17,15,"div",35),o(2,"div",36)(3,"div",37)(4,"div",38)(5,"div",39)(6,"div")(7,"div",40),_(8),k(9,"currency"),s()()()()()()()),i&2){let e=d.$implicit,n=c();r(),l("ngForOf",e),r(7),F("Total: ",O(9,2,n.totalOrder)," MXN")}}function je(i,d){if(i&1){let e=w();o(0,"div",57)(1,"div",58),y(2,"i",59),s(),o(3,"span",60),_(4),s(),o(5,"p",61),_(6),s(),o(7,"div",62)(8,"button",63),v("click",function(){m(e),c();let t=q(11);return p(t.accept())}),s(),o(9,"button",64),v("click",function(){m(e),c();let t=q(11);return p(t.reject())}),s()()()}if(i&2){let e=d.$implicit;r(4),F(" ",e.header," "),r(2),T(e.message)}}var ve=(()=>{class i{constructor(e,n,t,a,h,u,Ce,xe,ye){this.confirmationService=e,this.messageService=n,this._serviceAuth=t,this._serviceTable=a,this._serviceOrder=h,this._serviceDiner=u,this._serviceMeal=Ce,this.route=xe,this.hub=ye,this.items=[],this.order={},this.isLogin=!1,this.totalOrder=0,this.isRequestAttendace=!1,this.isRequestCheck=!1,this.diner={name_client:"Cliente an\xF3nimo"},this.suggestionsMeal=[],this.meals=[],this.tableIdentity="",this.instanceIdentity="",this.showModalDiner=!1,this.isLogin=t.checkLogin()}ngOnInit(){return E(this,null,function*(){this.isLogin||(this.hub.connect(),yield this.delay(1e3),this.hub.newUser().subscribe()),this.order.quantity=1,this.order.statusOrderId=1,this.tableIdentity=this.route.snapshot.paramMap.get("identity"),this.getTable(),this.getOrders(),this.getDiner(),yield this.delay(1e3),this.isLogin&&this.getMeals(),this.hub.receiveOrderFromTable().subscribe(e=>{this.getOrders()})})}ngOnDestroy(){}delay(e){return E(this,null,function*(){return new Promise(n=>setTimeout(n,e))})}getTable(){this._serviceTable.getByIdentity(this.tableIdentity).subscribe({next:e=>{console.log(e),this.table=e,this.instanceIdentity=e.instance.identity,this.isLogin||this.hub.joinGroupAnonymus(e.instance.identity)},error:e=>console.error(e)})}getOrders(){this._serviceOrder.getItemsByTable(this.tableIdentity).subscribe({next:e=>{console.log(e),this.items=e,this.items.forEach(n=>{n.isCancel||(this.totalOrder+=n.meal.price*n.quantity)})},error:e=>console.error(e)})}getDiner(){this._serviceDiner.getItemsByTable(this.tableIdentity).subscribe({next:e=>{e==null?this.showModalDiner=!0:this.diner=e},error:e=>console.error(e)})}getMeals(){this._serviceMeal.getByInstanceIdentity(this.table?.instance?.identity).subscribe({next:e=>{console.log("suggestionsMeal",e),this.meals=e},error:e=>console.error(e)})}requestAttendace(){this.table.isRequestCheck=!1,this.table.isRequestAttendace=!this.table.isRequestAttendace,this._serviceTable.request(this.table).subscribe({next:()=>{this.hub.sendNotificationTables(this.table)},error:e=>console.error(e)})}requestCheck(){this.table.isRequestCheck=!this.table.isRequestCheck,this.table.isRequestAttendace=!1,this._serviceTable.request(this.table).subscribe({next:()=>{this.hub.sendNotificationTables(this.table)},error:e=>console.error(e)})}focusSearchMeal(e){}searchMeal(e){let n=[],t=e.query;for(let a=0;a<this.meals.length;a++){let h=this.meals[a];h.name.toLowerCase().indexOf(t.toLowerCase())==0&&n.push(h)}this.suggestionsMeal=n}completeSelectMeal(e){this.order={mealId:e.value.id,tableId:this.table?.id,statusOrderId:1,quantity:1}}addOrder(){this.selectedItem&&(this.order.dinerId=this.diner.id,this._serviceOrder.createItem(this.order).subscribe({next:e=>{this.hub.sendOrder(this.order),this.order={},this.order.dinerId=this.diner.id,this.order.quantity=1,this.selectedItem=void 0},error:e=>console.error(e)}))}cancelOrder(e){e.isCancel=!0,this._serviceOrder.updateItem(e.id,e).subscribe({next:n=>{this.hub.sendOrder(e)},error:n=>console.error(n)})}confirmCancel(e){this.confirmationService.confirm({header:"Estas seguro de cancelar?",message:"Por favor de confirmar.",accept:()=>{this.cancelOrder(e)}})}changeStatusOrder(e,n){this.confirmationService.confirm({target:e.target,message:"",header:"Se entrego el alimento?",accept:()=>{n.statusOrderId=4,this._serviceOrder.updateItem(n.id,n).subscribe({next:t=>{this.hub.sendOrder(n)},error:t=>console.error(t)})}})}saveDiner(){this.table!=null&&(this.diner.tableId=this.table.id,this._serviceDiner.createItem(this.diner).subscribe({next:e=>{this.showModalDiner=!1},error:e=>{this.showModalDiner=!0}}))}static{this.\u0275fac=function(n){return new(n||i)(f(X),f(J),f(Y),f(ee),f($),f(ie),f(Z),f(Q),f(te))}}static{this.\u0275cmp=L({type:i,selectors:[["app-attendace"]],decls:25,vars:14,consts:[["dv",""],["cd",""],[1,"grid"],[1,"col-10","col-offset-1"],[3,"header"],["class","formgroup-inline",4,"ngIf"],["emptyMessage","Sin ordenes en proceso",3,"value"],["pTemplate","list"],["pTemplate","headless"],["header","Cliente","closable","false",3,"visibleChange","modal","visible"],[1,"formgrid","grid","gap-3","mb-3","mt-3"],[1,"field","col-12"],["for","name"],["pInputText","","id","name","type","text",1,"w-full",3,"ngModelChange","ngModel"],["for","phone"],["id","phone","mask","99-9999-9999","placeholder","99-9999-9999",3,"ngModelChange","ngModel"],[1,"flex","justify-content-end","gap-2"],["label","Guardar",3,"click"],[1,"formgroup-inline"],[1,"field","col-12","md:col-12","lg:col-9"],["placeholder","Buscar alimento(s) o bebida(s)","optionLabel","name",3,"ngModelChange","onFocus","completeMethod","onSelect","inputStyle","ngModel","suggestions","dropdown"],["pTemplate","item"],[1,"field","col-12","md:col-12","lg:col-2"],["placeholder","Cantidad","buttonLayout","horizontal","spinnerMode","horizontal","incrementButtonIcon","pi pi-plus","decrementButtonIcon","pi pi-minus",3,"ngModelChange","inputStyle","ngModel","showButtons","step","min","max"],[1,"col"],[1,"col-fixed"],["rows","1","cols","30","pInputTextarea","","placeholder","Complementos u/o Observaci\xF3n",3,"ngModelChange","autoResize","ngModel"],["pButton","","pRipple","","icon","pi pi-plus","label","Agregar",3,"click"],["class","field col-12 md:col-12 lg:col-4",4,"ngIf"],[1,"field","col-12","md:col-12","lg:col-4"],["label","Asistencia","icon","pi pi-bell","severity","info",3,"click","raised","ngClass"],[1,"field","col-12","md:col-12","lg:col-3"],["label","Cuenta","icon","pi pi-check",3,"click","raised","ngClass"],["label","Menu","icon","pi pi-list",3,"raised"],[1,"grid","grid-nogutter"],["class","col-12",4,"ngFor","ngForOf"],[1,"col-12"],[1,"flex","flex-column","sm:flex-row","sm:align-items-center","p-3","gap-3","border-top-1"],[1,"flex","flex-column","md:flex-row","justify-content-between","md:align-items-center","flex-1","gap-1"],[1,"flex","flex-row","md:flex-column","justify-content-between","align-items-start","gap-1"],[1,"text-lg","font-medium","text-900","mt-1"],[1,"grid",3,"ngClass"],["alt","dropdown icon","src","/assets/images/icon/ban.svg","style","width: 25px;",4,"ngIf"],["alt","dropdown icon","src","/assets/images/icon/process.svg","style","width: 25px;",4,"ngIf"],["alt","dropdown icon","src","/assets/images/icon/uniform.svg","style","width: 25px;",4,"ngIf"],["alt","dropdown icon","src","/assets/images/icon/delivery.svg","style","width: 25px;",4,"ngIf"],["alt","dropdown icon","src","/assets/images/icon/meal.svg","style","width: 25px;",4,"ngIf"],[1,"text-900","mt-1"],[1,"col-fixed","gap-1"],["class","col-fixed gap-1",4,"ngIf"],["alt","dropdown icon","src","/assets/images/icon/ban.svg",2,"width","25px"],["alt","dropdown icon","src","/assets/images/icon/process.svg",2,"width","25px"],["alt","dropdown icon","src","/assets/images/icon/uniform.svg",2,"width","25px"],["alt","dropdown icon","src","/assets/images/icon/delivery.svg",2,"width","25px"],["alt","dropdown icon","src","/assets/images/icon/meal.svg",2,"width","25px"],["icon","pi pi-check","severity","success","size","small",3,"onClick","disabled"],["icon","pi pi-ban","severity","danger","size","small",3,"onClick","disabled"],[1,"flex","flex-column","align-items-center","p-5","surface-overlay","border-round"],[1,"border-circle","bg-primary","inline-flex","justify-content-center","align-items-center","h-6rem","w-6rem"],[1,"pi","pi-question","text-5xl"],[1,"font-bold","text-2xl","block","mb-2","mt-4"],[1,"mb-0"],[1,"flex","align-items-center","gap-2","mt-4"],["pButton","","label","Si",1,"w-8rem",3,"click"],["pButton","","label","No",1,"p-button-outlined","w-8rem",3,"click"]],template:function(n,t){if(n&1){let a=w();o(0,"div",2)(1,"div",3)(2,"p-card",4),C(3,Me,6,18,"div",5)(4,Se,6,8,"div",5)(5,Ae,6,15,"div",5),o(6,"p-dataView",6,0),C(8,Le,10,4,"ng-template",7),s()()()(),y(9,"p-toast"),o(10,"p-confirmDialog",null,1),C(12,je,10,2,"ng-template",8),s(),o(13,"p-dialog",9),S("visibleChange",function(u){return m(a),M(t.showModalDiner,u)||(t.showModalDiner=u),p(u)}),o(14,"div",10)(15,"div",11)(16,"label",12),_(17,"Nombre del cliente"),s(),o(18,"input",13),S("ngModelChange",function(u){return m(a),M(t.diner.name_client,u)||(t.diner.name_client=u),p(u)}),s()(),o(19,"div",11)(20,"label",14),_(21,"Telefono del cliente"),s(),o(22,"p-inputMask",15),S("ngModelChange",function(u){return m(a),M(t.diner.phone_number,u)||(t.diner.phone_number=u),p(u)}),s()()(),o(23,"div",16)(24,"p-button",17),v("click",function(){return m(a),p(t.saveDiner())}),s()()()}n&2&&(r(2),j("header","Mesa ",t.table==null?null:t.table.name," a nombre de ",t.diner.name_client,""),r(),l("ngIf",t.isLogin),r(),l("ngIf",t.isLogin),r(),l("ngIf",!t.isLogin),r(),l("value",t.items),r(7),l("modal",!0),I("visible",t.showModalDiner),r(5),I("ngModel",t.diner.name_client),r(4),x(g(13,b)),I("ngModel",t.diner.phone_number))},dependencies:[N,R,P,ne,re,K,ae,G,H,U,oe,se,de,me,le,ce,ue,pe,_e,z],styles:[".item-cancel[_ngcontent-%COMP%]{background-color:var(--highlight-bg)!important;color:var(--surface-c)!important;text-decoration:line-through;text-decoration-color:#000!important}"]})}}return i})();var be=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=V({type:i})}static{this.\u0275inj=A({imports:[B.forChild([{path:"",component:ve}]),B]})}}return i})();var dt=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=V({type:i})}static{this.\u0275inj=A({imports:[be,ge]})}}return i})();export{dt as AttendaceModule};
