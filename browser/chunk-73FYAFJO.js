import{a as Se,b as Te}from"./chunk-I274AQX2.js";import{a as Ae,b as Oe}from"./chunk-L4BNHXMM.js";import{a as Ee,b as Ve}from"./chunk-KVEXNWIA.js";import{f as be,g as Ce,h as ye,i as Ie,j as we,k as Me}from"./chunk-737QNFMI.js";import"./chunk-MXMFQBGE.js";import{c as he,e as xe}from"./chunk-FDCLM4BU.js";import{b as ge,c as _e,d as fe}from"./chunk-BJ3AG4RX.js";import{a as ce,c as de,d as pe,e as me,g as ue}from"./chunk-JSWT4IH4.js";import{b as ie,c as ne,d as oe,g as F,i as re,l as ve}from"./chunk-YKTI5QJU.js";import"./chunk-4YRY4IP2.js";import{e as k,g as R,i as se,l as ae}from"./chunk-P3S5YJFO.js";import{$ as C,$a as Z,A as m,Aa as T,B as u,Ba as A,Ca as X,Ea as _,F as H,Fa as N,Ga as Y,H as W,Ka as O,La as E,N as o,O as p,Qa as J,Ra as K,V as G,W as h,Y as s,_ as $,_a as Q,ab as ee,db as te,e as q,ea as a,fa as l,fb as V,ga as v,ka as y,la as g,ma as c,pa as U,pb as le,r as I,ub as z,v as D,va as j,w,wa as x,x as P,xa as M,ya as B,za as S}from"./chunk-SBAOVUZ3.js";var Fe=(()=>{class t{el;ngModel;control;cd;config;autoResize;variant="outlined";onResize=new H;filled;cachedScrollHeight;ngModelSubscription;ngControlSubscription;constructor(e,n,i,r,f){this.el=e,this.ngModel=n,this.control=i,this.cd=r,this.config=f}ngOnInit(){this.ngModel&&(this.ngModelSubscription=this.ngModel.valueChanges.subscribe(()=>{this.updateState()})),this.control&&(this.ngControlSubscription=this.control.valueChanges.subscribe(()=>{this.updateState()}))}ngAfterViewInit(){this.autoResize&&this.resize(),this.updateFilledState(),this.cd.detectChanges()}onInput(e){this.updateState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length}resize(e){this.el.nativeElement.style.height="auto",this.el.nativeElement.style.height=this.el.nativeElement.scrollHeight+"px",parseFloat(this.el.nativeElement.style.height)>=parseFloat(this.el.nativeElement.style.maxHeight)?(this.el.nativeElement.style.overflowY="scroll",this.el.nativeElement.style.height=this.el.nativeElement.style.maxHeight):this.el.nativeElement.style.overflow="hidden",this.onResize.emit(e||{})}updateState(){this.updateFilledState(),this.autoResize&&this.resize()}ngOnDestroy(){this.ngModelSubscription&&this.ngModelSubscription.unsubscribe(),this.ngControlSubscription&&this.ngControlSubscription.unsubscribe()}static \u0275fac=function(n){return new(n||t)(p(W),p(F,8),p(ne,8),p(J),p(se))};static \u0275dir=P({type:t,selectors:[["","pInputTextarea",""]],hostAttrs:[1,"p-inputtextarea","p-inputtext","p-component","p-element"],hostVars:6,hostBindings:function(n,i){n&1&&g("input",function(f){return i.onInput(f)}),n&2&&$("p-filled",i.filled)("p-inputtextarea-resizable",i.autoResize)("p-variant-filled",i.variant==="filled"||i.config.inputStyle()==="filled")},inputs:{autoResize:[2,"autoResize","autoResize",K],variant:"variant"},outputs:{onResize:"onResize"},features:[G]})}return t})(),ke=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=w({type:t});static \u0275inj=I({imports:[V]})}return t})();var b=()=>({width:"100%"}),Re=t=>({"button-flash":t}),He=()=>({}),We=(t,d)=>({"border-top-1 surface-border":t,"item-cancel":d});function Ge(t,d){if(t&1&&(a(0,"div",2)(1,"div",15),x(2),l(),a(3,"div",16),x(4),O(5,"currency"),l()()),t&2){let e=d.$implicit;o(2),M(e.name),o(2),M(E(5,2,e.price))}}function $e(t,d){if(t&1){let e=y();a(0,"div",9)(1,"div",10)(2,"p-autoComplete",11),A("ngModelChange",function(i){m(e);let r=c();return T(r.selectedItem,i)||(r.selectedItem=i),u(i)}),g("onFocus",function(i){m(e);let r=c();return u(r.focusSearchMeal(i))})("completeMethod",function(i){m(e);let r=c();return u(r.searchMeal(i))})("onSelect",function(i){m(e);let r=c();return u(r.completeSelectMeal(i))}),h(3,Ge,6,4,"ng-template",12),l()(),a(4,"div",13)(5,"p-inputNumber",14),A("ngModelChange",function(i){m(e);let r=c();return T(r.order.quantity,i)||(r.order.quantity=i),u(i)}),l()()()}if(t&2){let e=c();o(2),C(_(14,b)),s("inputStyle",_(15,b)),S("ngModel",e.selectedItem),s("suggestions",e.suggestionsMeal)("dropdown",!0),o(3),C(_(16,b)),s("inputStyle",_(17,b)),S("ngModel",e.order.quantity),s("showButtons",!0)("step",1)("min",1)("max",100)}}function Ue(t,d){if(t&1){let e=y();a(0,"div",9)(1,"div",10)(2,"textarea",17),A("ngModelChange",function(i){m(e);let r=c();return T(r.order.aditional,i)||(r.order.aditional=i),u(i)}),x(3,"                    "),l()(),a(4,"div",13)(5,"button",18),g("click",function(){m(e);let i=c();return u(i.addOrder())}),l()()()}if(t&2){let e=c();o(2),C(_(6,b)),s("autoResize",!0),S("ngModel",e.order.aditional),o(3),C(_(7,b))}}function Xe(t,d){t&1&&(a(0,"div",20),v(1,"p-button",24),l()),t&2&&(o(),C(_(3,b)),s("raised",!0))}function Ye(t,d){if(t&1){let e=y();a(0,"div",9),h(1,Xe,2,4,"div",19),a(2,"div",20)(3,"p-button",21),g("click",function(){m(e);let i=c();return u(i.requestAttendace())}),l()(),a(4,"div",22)(5,"p-button",23),g("click",function(){m(e);let i=c();return u(i.requestCheck())}),l()()()}if(t&2){let e=c();o(),s("ngIf",!1),o(2),C(_(9,b)),s("raised",!0)("ngClass",N(10,Re,e.table==null?null:e.table.isRequestAttendace)),o(2),C(_(12,b)),s("raised",!0)("ngClass",N(13,Re,e.table==null?null:e.table.isRequestCheck))}}function Je(t,d){t&1&&v(0,"img",42)}function Ke(t,d){t&1&&v(0,"img",43)}function Qe(t,d){t&1&&v(0,"img",44)}function Ze(t,d){t&1&&v(0,"img",45)}function et(t,d){t&1&&v(0,"img",46)}function tt(t,d){if(t&1){let e=y();a(0,"div",40)(1,"p-button",47),g("onClick",function(i){m(e);let r=c().$implicit,f=c(2);return u(f.changeStatusOrder(i,r))}),l()()}if(t&2){let e=c().$implicit;o(),s("disabled",e.statusOrderId!=3)}}function it(t,d){if(t&1){let e=y();a(0,"div",40)(1,"p-button",48),g("onClick",function(){m(e);let i=c().$implicit,r=c(2);return u(r.confirmCancel(i))}),l()()}if(t&2){let e=c().$implicit;o(),s("disabled",e.isCancel||e.statusOrderId>=3)}}function nt(t,d){if(t&1&&(a(0,"div",32)(1,"div",33)(2,"div",16),h(3,Je,1,0,"img",34)(4,Ke,1,0,"img",35)(5,Qe,1,0,"img",36)(6,Ze,1,0,"img",37)(7,et,1,0,"img",38),l(),a(8,"div",15)(9,"div",39),x(10),l()(),a(11,"div",40)(12,"div",39),x(13),O(14,"currency"),l()(),h(15,tt,2,1,"div",41)(16,it,2,1,"div",41),l()()),t&2){let e=d.$implicit,n=d.first,i=c(2);s("ngClass",_(13,He)),o(),s("ngClass",Y(14,We,!n,e.isCancel)),o(2),s("ngIf",e.isCancel),o(),s("ngIf",e.statusOrderId==1&&!e.isCancel),o(),s("ngIf",e.statusOrderId==2&&!e.isCancel),o(),s("ngIf",e.statusOrderId==3&&!e.isCancel),o(),s("ngIf",e.statusOrderId==4&&!e.isCancel),o(3),M(e.quantity+" "+(e.meal==null?null:e.meal.name)),o(3),M(E(14,11,(e.meal==null?null:e.meal.price)*e.quantity)),o(2),s("ngIf",i.isLogin),o(),s("ngIf",i.isLogin)}}function ot(t,d){if(t&1&&(a(0,"div",25),h(1,nt,17,17,"div",26),a(2,"div",27)(3,"div",28)(4,"div",29)(5,"div",30)(6,"div")(7,"div",31),x(8),O(9,"currency"),l()()()()()()()),t&2){let e=d.$implicit,n=c();o(),s("ngForOf",e),o(7),B("Total: ",E(9,2,n.totalOrder)," MXN")}}function rt(t,d){if(t&1){let e=y();a(0,"div",49)(1,"div",50),v(2,"i",51),l(),a(3,"span",52),x(4),l(),a(5,"p",53),x(6),l(),a(7,"div",54)(8,"button",55),g("click",function(){m(e),c();let i=j(11);return u(i.accept())}),l(),a(9,"button",56),g("click",function(){m(e),c();let i=j(11);return u(i.reject())}),l()()()}if(t&2){let e=d.$implicit;o(4),B(" ",e.header," "),o(2),M(e.message)}}var qe=(()=>{class t{constructor(e,n,i,r,f,Be,Ne,ze){this.confirmationService=e,this.messageService=n,this._serviceAuth=i,this._serviceTable=r,this._serviceOrder=f,this._serviceMeal=Be,this.route=Ne,this.hub=ze,this.items=[],this.order={},this.isLogin=!1,this.totalOrder=0,this.isRequestAttendace=!1,this.isRequestCheck=!1,this.suggestionsMeal=[],this.meals=[],this.tableIdentity="",this.instanceIdentity="",this.isLogin=i.checkLogin()}ngOnInit(){return q(this,null,function*(){this.isLogin||(this.hub.connect(),yield this.delay(1e3),this.hub.newUser().subscribe()),this.order.quantity=1,this.order.statusOrderId=1,this.tableIdentity=this.route.snapshot.paramMap.get("identity"),this.getTable(),this.getOrders(),yield this.delay(1e3),this.isLogin&&this.getMeals(),this.hub.receiveOrderFromTable().subscribe(e=>{this.getOrders()})})}ngOnDestroy(){}delay(e){return q(this,null,function*(){return new Promise(n=>setTimeout(n,e))})}getTable(){this._serviceTable.getByIdentity(this.tableIdentity).subscribe({next:e=>{console.log(e),this.table=e,this.instanceIdentity=e.instance.identity,this.isLogin||this.hub.joinGroupAnonymus(e.instance.identity)},error:e=>console.error(e)})}getOrders(){this._serviceOrder.getItemsByTable(this.tableIdentity).subscribe({next:e=>{console.log(e),this.items=e,this.items.forEach(n=>{n.isCancel||(this.totalOrder+=n.meal.price*n.quantity)})},error:e=>console.error(e)})}getMeals(){this._serviceMeal.getByInstanceIdentity(this.table?.instance?.identity).subscribe({next:e=>{console.log("suggestionsMeal",e),this.meals=e},error:e=>console.error(e)})}requestAttendace(){this.table.isRequestCheck=!1,this.table.isRequestAttendace=!this.table.isRequestAttendace,this._serviceTable.request(this.table).subscribe({next:()=>{this.hub.sendNotificationTables(this.table)},error:e=>console.error(e)})}requestCheck(){this.table.isRequestCheck=!this.table.isRequestCheck,this.table.isRequestAttendace=!1,this._serviceTable.request(this.table).subscribe({next:()=>{this.hub.sendNotificationTables(this.table)},error:e=>console.error(e)})}focusSearchMeal(e){}searchMeal(e){let n=[],i=e.query;for(let r=0;r<this.meals.length;r++){let f=this.meals[r];f.name.toLowerCase().indexOf(i.toLowerCase())==0&&n.push(f)}this.suggestionsMeal=n}completeSelectMeal(e){this.order={mealId:e.value.id,tableId:this.table?.id,statusOrderId:1,quantity:1}}addOrder(){this.selectedItem&&this._serviceOrder.createItem(this.order).subscribe({next:e=>{this.hub.sendOrder(this.order),this.order={},this.order.quantity=1,this.selectedItem=void 0},error:e=>console.error(e)})}cancelOrder(e){e.isCancel=!0,this._serviceOrder.updateItem(e.id,e).subscribe({next:n=>{this.hub.sendOrder(e)},error:n=>console.error(n)})}confirmCancel(e){this.confirmationService.confirm({header:"Estas seguro de cancelar?",message:"Por favor de confirmar.",accept:()=>{this.cancelOrder(e)}})}changeStatusOrder(e,n){this.confirmationService.confirm({target:e.target,message:"",header:"Se entrego el alimento?",accept:()=>{n.statusOrderId=4,this._serviceOrder.updateItem(n.id,n).subscribe({next:i=>{this.hub.sendOrder(n)},error:i=>console.error(i)})}})}static{this.\u0275fac=function(n){return new(n||t)(p(k),p(R),p(ce),p(me),p(pe),p(de),p(le),p(ue))}}static{this.\u0275cmp=D({type:t,selectors:[["app-attendace"]],features:[X([k,R])],decls:13,vars:5,consts:[["dv",""],["cd",""],[1,"grid"],[1,"col-10","col-offset-1"],[3,"header"],["class","formgroup-inline",4,"ngIf"],["emptyMessage","Sin ordenes en proceso",3,"value"],["pTemplate","list"],["pTemplate","headless"],[1,"formgroup-inline"],[1,"field","col-12","md:col-12","lg:col-9"],["placeholder","Buscar alimento(s) o bebida(s)","optionLabel","name",3,"ngModelChange","onFocus","completeMethod","onSelect","inputStyle","ngModel","suggestions","dropdown"],["pTemplate","item"],[1,"field","col-12","md:col-12","lg:col-2"],["placeholder","Cantidad","buttonLayout","horizontal","spinnerMode","horizontal","incrementButtonIcon","pi pi-plus","decrementButtonIcon","pi pi-minus",3,"ngModelChange","inputStyle","ngModel","showButtons","step","min","max"],[1,"col"],[1,"col-fixed"],["rows","1","cols","30","pInputTextarea","","placeholder","Complementos u/o Observaci\xF3n",3,"ngModelChange","autoResize","ngModel"],["pButton","","pRipple","","icon","pi pi-plus","label","Agregar",3,"click"],["class","field col-12 md:col-12 lg:col-4",4,"ngIf"],[1,"field","col-12","md:col-12","lg:col-4"],["label","Asistencia","icon","pi pi-bell","severity","info",3,"click","raised","ngClass"],[1,"field","col-12","md:col-12","lg:col-3"],["label","Cuenta","icon","pi pi-check",3,"click","raised","ngClass"],["label","Menu","icon","pi pi-list",3,"raised"],[1,"grid","grid-nogutter"],["class","col-12",3,"ngClass",4,"ngFor","ngForOf"],[1,"col-12"],[1,"flex","flex-column","sm:flex-row","sm:align-items-center","p-3","gap-3","border-top-1"],[1,"flex","flex-column","md:flex-row","justify-content-between","md:align-items-center","flex-1","gap-1"],[1,"flex","flex-row","md:flex-column","justify-content-between","align-items-start","gap-1"],[1,"text-lg","font-medium","text-900","mt-1"],[1,"col-12",3,"ngClass"],[1,"grid",3,"ngClass"],["alt","dropdown icon","src","/assets/images/icon/ban.svg","style","width: 25px;",4,"ngIf"],["alt","dropdown icon","src","/assets/images/icon/process.svg","style","width: 25px;",4,"ngIf"],["alt","dropdown icon","src","/assets/images/icon/uniform.svg","style","width: 25px;",4,"ngIf"],["alt","dropdown icon","src","/assets/images/icon/delivery.svg","style","width: 25px;",4,"ngIf"],["alt","dropdown icon","src","/assets/images/icon/meal.svg","style","width: 25px;",4,"ngIf"],[1,"text-900","mt-1"],[1,"col-fixed","gap-1"],["class","col-fixed gap-1",4,"ngIf"],["alt","dropdown icon","src","/assets/images/icon/ban.svg",2,"width","25px"],["alt","dropdown icon","src","/assets/images/icon/process.svg",2,"width","25px"],["alt","dropdown icon","src","/assets/images/icon/uniform.svg",2,"width","25px"],["alt","dropdown icon","src","/assets/images/icon/delivery.svg",2,"width","25px"],["alt","dropdown icon","src","/assets/images/icon/meal.svg",2,"width","25px"],["icon","pi pi-check","severity","success",3,"onClick","disabled"],["icon","pi pi-ban","severity","danger",3,"onClick","disabled"],[1,"flex","flex-column","align-items-center","p-5","surface-overlay","border-round"],[1,"border-circle","bg-primary","inline-flex","justify-content-center","align-items-center","h-6rem","w-6rem"],[1,"pi","pi-question","text-5xl"],[1,"font-bold","text-2xl","block","mb-2","mt-4"],[1,"mb-0"],[1,"flex","align-items-center","gap-2","mt-4"],["pButton","","label","Si",1,"w-8rem",3,"click"],["pButton","","label","No",1,"p-button-outlined","w-8rem",3,"click"]],template:function(n,i){n&1&&(a(0,"div",2)(1,"div",3)(2,"p-card",4),h(3,$e,6,18,"div",5)(4,Ue,6,8,"div",5)(5,Ye,6,15,"div",5),a(6,"p-dataView",6,0),h(8,ot,10,4,"ng-template",7),l()()()(),v(9,"p-toast"),a(10,"p-confirmDialog",null,1),h(12,rt,10,2,"ng-template",8),l()),n&2&&(o(2),U("header",i.table==null?null:i.table.name),o(),s("ngIf",i.isLogin),o(),s("ngIf",i.isLogin),o(),s("ngIf",!i.isLogin),o(),s("value",i.items))},dependencies:[Q,Z,ee,ge,_e,ae,ie,oe,F,ye,we,Ee,be,Fe,Se,Ae,te],styles:[".item-cancel[_ngcontent-%COMP%]{background-color:var(--highlight-bg)!important;color:var(--surface-c)!important;text-decoration:line-through;text-decoration-color:#000!important}"]})}}return t})();var je=(()=>{class t{static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275mod=w({type:t})}static{this.\u0275inj=I({imports:[z.forChild([{path:"",component:qe}]),z]})}}return t})();var $t=(()=>{class t{static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275mod=w({type:t})}static{this.\u0275inj=I({imports:[V,je,fe,he,ve,re,xe,Ie,Me,Ve,Ce,ke,Te,Oe]})}}return t})();export{$t as AttendaceModule};
