<p-toast></p-toast>
<div class="card">
    <h5>{{isEditMode ? 'Edit Promotion' : 'New Promotion'}}</h5>
    <form [formGroup]="promotionForm" (ngSubmit)="onSubmit()">
        <div class="p-fluid grid formgrid">
            <div class="field col-12 md:col-6">
                <label for="code">Code</label>
                <input pInputText id="code" formControlName="code" type="text" />
                <small *ngIf="promotionForm.get('code')?.invalid && (promotionForm.get('code')?.dirty || promotionForm.get('code')?.touched)" class="p-error">Code is required.</small>
            </div>
            <div class="field col-12 md:col-6">
                <label for="discountType">Discount Type</label>
                <p-dropdown id="discountType" [options]="discountTypes" formControlName="discountType" optionLabel="label" optionValue="value"></p-dropdown>
            </div>
            <div class="field col-12 md:col-6">
                <label for="discountValue">Discount Value</label>
                <p-inputNumber id="discountValue" formControlName="discountValue"></p-inputNumber>
                <small *ngIf="promotionForm.get('discountValue')?.invalid && (promotionForm.get('discountValue')?.dirty || promotionForm.get('discountValue')?.touched)" class="p-error">Value is required and must be non-negative.</small>
            </div>
            <div class="field col-12 md:col-6">
                <label for="maxUsage">Max Usage</label>
                <p-inputNumber id="maxUsage" formControlName="maxUsage"></p-inputNumber>
                <small *ngIf="promotionForm.get('maxUsage')?.invalid && (promotionForm.get('maxUsage')?.dirty || promotionForm.get('maxUsage')?.touched)" class="p-error">Max Usage is required.</small>
            </div>
            <div class="field col-12 md:col-6">
                <label for="validFrom">Valid From</label>
                <p-calendar id="validFrom" formControlName="validFrom" [showIcon]="true"></p-calendar>
                <small *ngIf="promotionForm.get('validFrom')?.invalid && (promotionForm.get('validFrom')?.dirty || promotionForm.get('validFrom')?.touched)" class="p-error">Valid From date is required.</small>
            </div>
            <div class="field col-12 md:col-6">
                <label for="validTo">Valid To</label>
                <p-calendar id="validTo" formControlName="validTo" [showIcon]="true"></p-calendar>
                <small *ngIf="promotionForm.get('validTo')?.invalid && (promotionForm.get('validTo')?.dirty || promotionForm.get('validTo')?.touched)" class="p-error">Valid To date is required.</small>
            </div>
        </div>
        <div class="flex justify-content-end gap-2">
            <button pButton pRipple label="Cancel" icon="pi pi-times" class="p-button-secondary" [routerLink]="['/admin/promotions']" type="button"></button>
            <button pButton pRipple label="Save" icon="pi pi-check" class="p-button-primary" type="submit" [disabled]="promotionForm.invalid || loading"></button>
        </div>
    </form>
</div>
