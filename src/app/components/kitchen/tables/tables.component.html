<div class="tables-container">
    <!-- Header -->
    <div class="page-header glass-card mb-4">
        <div class="page-title">
            <h1>Mesas</h1>
            <p class="page-subtitle">Gesti贸n de mesas del restaurante</p>
        </div>
    </div>

    <!-- Grid de mesas -->
    <div class="grid" *ngIf="tables && tables.length > 0">
        <div class="col-12 md:col-6 lg:col-4 xl:col-3" 
             *ngFor="let table of tables; let i = index"
             class="stagger-item"
             [style.animation-delay]="(i * 0.05) + 's'">
            
            <div class="table-card glass-card hover-lift"
                 [class.table-available]="!isTableBusy(table)"
                 [class.table-occupied]="isTableBusy(table)"
                 [class.table-alert]="table.isRequestAttendace || table.isRequestCheck">
                
                <!-- Status badge flotante -->
                <div class="table-status-badge">
                    <p-tag [value]="isTableBusy(table) ? 'Ocupada' : 'Disponible'"
                           [severity]="isTableBusy(table) ? 'danger' : 'success'"
                           [rounded]="true"></p-tag>
                </div>

                <!-- Nombre de mesa -->
                <h3 class="table-name">
                    <i class="pi" [ngClass]="isTableBusy(table) ? 'pi-bookmark-fill' : 'pi-bookmark'"></i>
                    {{table.name}}
                </h3>

                <!-- Alertas si existen -->
                <div class="table-alerts" *ngIf="table.isRequestAttendace || table.isRequestCheck">
                    <div class="alert-item pulse" *ngIf="table.isRequestAttendace">
                        <i class="pi pi-flag-fill"></i>
                        <span>Asistencia solicitada</span>
                    </div>
                    <div class="alert-item pulse" *ngIf="table.isRequestCheck">
                        <i class="pi pi-dollar"></i>
                        <span>Cuenta solicitada</span>
                    </div>
                </div>

                <!-- Acciones -->
                <div class="table-actions">
                    <button pButton 
                            label="Ver Mesa" 
                            icon="pi pi-sign-in"
                            class="w-full mb-2"
                            [routerLink]="['/kitchen/table', table.identity]"></button>
                    <button pButton 
                            label="Mostrar QR" 
                            icon="pi pi-qrcode"
                            class="w-full" 
                            severity="secondary"
                            (click)="showQRModal(table)"></button>
                </div>
            </div>
        </div>
    </div>

    <!-- Empty state -->
    <div class="empty-state-card" *ngIf="!tables || tables.length === 0">
        <div class="empty-icon">
            <i class="pi pi-table"></i>
        </div>
        <h3 class="empty-title">No hay mesas configuradas</h3>
        <p class="empty-message">
            Configura tus mesas en la secci贸n de configuraci贸n para comenzar a gestionar tu restaurante.
        </p>
        <div class="empty-action">
            <button pButton 
                    label="Ir a Configuraci贸n" 
                    icon="pi pi-cog"
                    routerLink="/settings"></button>
        </div>
    </div>
</div>

<!-- Modal QR -->
<p-dialog header="QR de mesa {{table?.name}}" 
          [modal]="true" 
          [(visible)]="visibleQRModal"
          [style]="{width: '450px'}"
          [dismissableMask]="true">
    <div class="flex justify-content-center align-items-center p-4">
        <qrcode
            #parent
            [elementType]="elementType"
            [errorCorrectionLevel]="qrData.errorCorrectionLevel"
            [qrdata]="qrData.qrdata"
            [scale]="qrData.scale"
            [width]="qrData.width"
            [allowEmptyString]="true"
            [className]="qrData.cssClass"
            [colorDark]="qrData.colorDark"
            [colorLight]="qrData.colorLight"
            [margin]="qrData.margin"
            [alt]="qrData.alt"
            [ariaLabel]="qrData.ariaLabel"
            [title]="qrData.title"
            [imageSrc]="qrData.imageSrc"
            [imageHeight]="qrData.imageHeight"
            [imageWidth]="qrData.imageWidth">
        </qrcode>
    </div>
    <ng-template pTemplate="footer">
        <button pButton label="Cerrar" severity="secondary" (click)="visibleQRModal = false"></button>
    </ng-template>
</p-dialog>

<!-- Toast notifications -->
<p-toast position="top-center"></p-toast>
