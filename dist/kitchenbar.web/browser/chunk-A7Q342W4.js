import{a as Ae,b as Oe}from"./chunk-KISY56WU.js";import{a as Ee,b as Ve}from"./chunk-H2LM4TNQ.js";import{a as Fe,b as ke}from"./chunk-KB7CDDPS.js";import{f as ye,g as Ie,h as we,i as Me,j as Se,k as Te}from"./chunk-FYYOUDWT.js";import"./chunk-UQHMDMBN.js";import{c as xe,e as Ce}from"./chunk-6KHCE25A.js";import{b as _e,c as he,d as ve}from"./chunk-QUUG4HCO.js";import{a as pe,c as me,d as ue,e as ge,g as fe}from"./chunk-JSWT4IH4.js";import{b as oe,c as re,d as se,g as k,i as ae,l as be}from"./chunk-FI7I4ISR.js";import"./chunk-XSSXK7EZ.js";import{e as q,g as R,i as le,l as ce}from"./chunk-YYX7IYLV.js";import{$a as ee,Aa as N,B as m,Ba as T,C as u,Ca as A,Da as O,Ea as J,G,Ga as _,H as $,Ha as z,Ia as K,Ma as E,N as s,Na as V,O as p,Sa as Q,Ta as Z,X as U,Y as h,_ as a,aa as X,ab as te,ba as C,bb as ie,e as j,eb as ne,ga as l,gb as F,ha as c,ia as v,ma as y,na as f,oa as d,pb as de,r as I,ra as Y,ub as D,v as P,w as H,x as w,xa as B,y as W,ya as x,za as M}from"./chunk-EN5K7PU7.js";var qe=(()=>{class n{el;ngModel;control;cd;config;autoResize;variant="outlined";onResize=new $;filled;cachedScrollHeight;ngModelSubscription;ngControlSubscription;constructor(i,e,t,r,g){this.el=i,this.ngModel=e,this.control=t,this.cd=r,this.config=g}ngOnInit(){this.ngModel&&(this.ngModelSubscription=this.ngModel.valueChanges.subscribe(()=>{this.updateState()})),this.control&&(this.ngControlSubscription=this.control.valueChanges.subscribe(()=>{this.updateState()}))}ngAfterViewInit(){this.autoResize&&this.resize(),this.updateFilledState(),this.cd.detectChanges()}onInput(i){this.updateState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length}resize(i){this.el.nativeElement.style.height="auto",this.el.nativeElement.style.height=this.el.nativeElement.scrollHeight+"px",parseFloat(this.el.nativeElement.style.height)>=parseFloat(this.el.nativeElement.style.maxHeight)?(this.el.nativeElement.style.overflowY="scroll",this.el.nativeElement.style.height=this.el.nativeElement.style.maxHeight):this.el.nativeElement.style.overflow="hidden",this.onResize.emit(i||{})}updateState(){this.updateFilledState(),this.autoResize&&this.resize()}ngOnDestroy(){this.ngModelSubscription&&this.ngModelSubscription.unsubscribe(),this.ngControlSubscription&&this.ngControlSubscription.unsubscribe()}static \u0275fac=function(e){return new(e||n)(p(G),p(k,8),p(re,8),p(Q),p(le))};static \u0275dir=W({type:n,selectors:[["","pInputTextarea",""]],hostAttrs:[1,"p-inputtextarea","p-inputtext","p-component","p-element"],hostVars:6,hostBindings:function(e,t){e&1&&f("input",function(g){return t.onInput(g)}),e&2&&X("p-filled",t.filled)("p-inputtextarea-resizable",t.autoResize)("p-variant-filled",t.variant==="filled"||t.config.inputStyle()==="filled")},inputs:{autoResize:[P.HasDecoratorInputTransform,"autoResize","autoResize",Z],variant:"variant"},outputs:{onResize:"onResize"},features:[U]})}return n})(),Re=(()=>{class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=w({type:n});static \u0275inj=I({imports:[F]})}return n})();var b=()=>({width:"100%"}),je=n=>({"button-flash":n}),Ge=()=>({}),$e=(n,o)=>({"border-top-1 surface-border":n,"item-cancel":o});function Ue(n,o){if(n&1&&(l(0,"div",2)(1,"div",15),x(2),c(),l(3,"div",16),x(4),E(5,"currency"),c()()),n&2){let i=o.$implicit;s(2),M(i.name),s(2),M(V(5,2,i.price))}}function Xe(n,o){if(n&1){let i=y();l(0,"div",9)(1,"div",10)(2,"p-autoComplete",11),O("ngModelChange",function(t){m(i);let r=d();return A(r.selectedItem,t)||(r.selectedItem=t),u(t)}),f("onFocus",function(t){m(i);let r=d();return u(r.focusSearchMeal(t))})("completeMethod",function(t){m(i);let r=d();return u(r.searchMeal(t))})("onSelect",function(t){m(i);let r=d();return u(r.completeSelectMeal(t))}),h(3,Ue,6,4,"ng-template",12),c()(),l(4,"div",13)(5,"p-inputNumber",14),O("ngModelChange",function(t){m(i);let r=d();return A(r.order.quantity,t)||(r.order.quantity=t),u(t)}),c()()()}if(n&2){let i=d();s(2),C(_(14,b)),a("inputStyle",_(15,b)),T("ngModel",i.selectedItem),a("suggestions",i.suggestionsMeal)("dropdown",!0),s(3),C(_(16,b)),a("inputStyle",_(17,b)),T("ngModel",i.order.quantity),a("showButtons",!0)("step",1)("min",1)("max",100)}}function Ye(n,o){if(n&1){let i=y();l(0,"div",9)(1,"div",10)(2,"textarea",17),O("ngModelChange",function(t){m(i);let r=d();return A(r.order.aditional,t)||(r.order.aditional=t),u(t)}),x(3,"                    "),c()(),l(4,"div",13)(5,"button",18),f("click",function(){m(i);let t=d();return u(t.addOrder())}),c()()()}if(n&2){let i=d();s(2),C(_(6,b)),a("autoResize",!0),T("ngModel",i.order.aditional),s(3),C(_(7,b))}}function Je(n,o){n&1&&(l(0,"div",20),v(1,"p-button",24),c()),n&2&&(s(),C(_(3,b)),a("raised",!0))}function Ke(n,o){if(n&1){let i=y();l(0,"div",9),h(1,Je,2,4,"div",19),l(2,"div",20)(3,"p-button",21),f("click",function(){m(i);let t=d();return u(t.requestAttendace())}),c()(),l(4,"div",22)(5,"p-button",23),f("click",function(){m(i);let t=d();return u(t.requestCheck())}),c()()()}if(n&2){let i=d();s(),a("ngIf",!1),s(2),C(_(9,b)),a("raised",!0)("ngClass",z(10,je,i.table==null?null:i.table.isRequestAttendace)),s(2),C(_(12,b)),a("raised",!0)("ngClass",z(13,je,i.table==null?null:i.table.isRequestCheck))}}function Qe(n,o){n&1&&v(0,"img",42)}function Ze(n,o){n&1&&v(0,"img",43)}function et(n,o){n&1&&v(0,"img",44)}function tt(n,o){n&1&&v(0,"img",45)}function it(n,o){n&1&&v(0,"img",46)}function nt(n,o){if(n&1){let i=y();l(0,"div",40)(1,"p-button",47),f("onClick",function(t){m(i);let r=d().$implicit,g=d(2);return u(g.changeStatusOrder(t,r))}),c()()}if(n&2){let i=d().$implicit;s(),a("disabled",i.statusOrderId!=3)}}function ot(n,o){if(n&1){let i=y();l(0,"div",40)(1,"p-button",48),f("onClick",function(){m(i);let t=d().$implicit,r=d(2);return u(r.confirmCancel(t))}),c()()}if(n&2){let i=d().$implicit;s(),a("disabled",i.isCancel||i.statusOrderId>=3)}}function rt(n,o){if(n&1&&(l(0,"div",32)(1,"div",33)(2,"div",16),h(3,Qe,1,0,"img",34)(4,Ze,1,0,"img",35)(5,et,1,0,"img",36)(6,tt,1,0,"img",37)(7,it,1,0,"img",38),c(),l(8,"div",15)(9,"div",39),x(10),c()(),l(11,"div",40)(12,"div",39),x(13),E(14,"currency"),c()(),h(15,nt,2,1,"div",41)(16,ot,2,1,"div",41),c()()),n&2){let i=o.$implicit,e=o.first,t=d(2);a("ngClass",_(13,Ge)),s(),a("ngClass",K(14,$e,!e,i.isCancel)),s(2),a("ngIf",i.isCancel),s(),a("ngIf",i.statusOrderId==1&&!i.isCancel),s(),a("ngIf",i.statusOrderId==2&&!i.isCancel),s(),a("ngIf",i.statusOrderId==3&&!i.isCancel),s(),a("ngIf",i.statusOrderId==4&&!i.isCancel),s(3),M(i.quantity+" "+(i.meal==null?null:i.meal.name)),s(3),M(V(14,11,(i.meal==null?null:i.meal.price)*i.quantity)),s(2),a("ngIf",t.isLogin),s(),a("ngIf",t.isLogin)}}function st(n,o){if(n&1&&(l(0,"div",25),h(1,rt,17,17,"div",26),l(2,"div",27)(3,"div",28)(4,"div",29)(5,"div",30)(6,"div")(7,"div",31),x(8),E(9,"currency"),c()()()()()()()),n&2){let i=o.$implicit,e=d();s(),a("ngForOf",i),s(7),N("Total: ",V(9,2,e.totalOrder)," MXN")}}function at(n,o){if(n&1){let i=y();l(0,"div",49)(1,"div",50),v(2,"i",51),c(),l(3,"span",52),x(4),c(),l(5,"p",53),x(6),c(),l(7,"div",54)(8,"button",55),f("click",function(){m(i),d();let t=B(11);return u(t.accept())}),c(),l(9,"button",56),f("click",function(){m(i),d();let t=B(11);return u(t.reject())}),c()()()}if(n&2){let i=o.$implicit;s(4),N(" ",i.header," "),s(2),M(i.message)}}var Be=(()=>{let o=class o{constructor(e,t,r,g,S,ze,De,Le){this.confirmationService=e,this.messageService=t,this._serviceAuth=r,this._serviceTable=g,this._serviceOrder=S,this._serviceMeal=ze,this.route=De,this.hub=Le,this.items=[],this.order={},this.isLogin=!1,this.totalOrder=0,this.isRequestAttendace=!1,this.isRequestCheck=!1,this.suggestionsMeal=[],this.meals=[],this.tableIdentity="",this.instanceIdentity="",this.isLogin=r.checkLogin()}ngOnInit(){return j(this,null,function*(){this.isLogin||(this.hub.connect(),yield this.delay(1e3),this.hub.newUser().subscribe()),this.order.quantity=1,this.order.statusOrderId=1,this.tableIdentity=this.route.snapshot.paramMap.get("identity"),this.getTable(),this.getOrders(),yield this.delay(1e3),this.isLogin&&this.getMeals(),this.hub.receiveOrderFromTable().subscribe(e=>{this.getOrders()})})}ngOnDestroy(){}delay(e){return j(this,null,function*(){return new Promise(t=>setTimeout(t,e))})}getTable(){this._serviceTable.getByIdentity(this.tableIdentity).subscribe({next:e=>{console.log(e),this.table=e,this.instanceIdentity=e.instance.identity,this.isLogin||this.hub.joinGroupAnonymus(e.instance.identity)},error:e=>console.error(e)})}getOrders(){this._serviceOrder.getItemsByTable(this.tableIdentity).subscribe({next:e=>{console.log(e),this.items=e,this.items.forEach(t=>{t.isCancel||(this.totalOrder+=t.meal.price*t.quantity)})},error:e=>console.error(e)})}getMeals(){this._serviceMeal.getByInstanceIdentity(this.table?.instance?.identity).subscribe({next:e=>{console.log("suggestionsMeal",e),this.meals=e},error:e=>console.error(e)})}requestAttendace(){this.table.isRequestCheck=!1,this.table.isRequestAttendace=!this.table.isRequestAttendace,this._serviceTable.request(this.table).subscribe({next:()=>{this.hub.sendNotificationTables(this.table)},error:e=>console.error(e)})}requestCheck(){this.table.isRequestCheck=!this.table.isRequestCheck,this.table.isRequestAttendace=!1,this._serviceTable.request(this.table).subscribe({next:()=>{this.hub.sendNotificationTables(this.table)},error:e=>console.error(e)})}focusSearchMeal(e){}searchMeal(e){let t=[],r=e.query;for(let g=0;g<this.meals.length;g++){let S=this.meals[g];S.name.toLowerCase().indexOf(r.toLowerCase())==0&&t.push(S)}this.suggestionsMeal=t}completeSelectMeal(e){this.order={mealId:e.value.id,tableId:this.table?.id,statusOrderId:1,quantity:1}}addOrder(){this.selectedItem&&this._serviceOrder.createItem(this.order).subscribe({next:e=>{this.hub.sendOrder(this.order),this.order={},this.order.quantity=1,this.selectedItem=void 0},error:e=>console.error(e)})}cancelOrder(e){e.isCancel=!0,this._serviceOrder.updateItem(e.id,e).subscribe({next:t=>{this.hub.sendOrder(e)},error:t=>console.error(t)})}confirmCancel(e){this.confirmationService.confirm({header:"Estas seguro de cancelar?",message:"Por favor de confirmar.",accept:()=>{this.cancelOrder(e)}})}changeStatusOrder(e,t){this.confirmationService.confirm({target:e.target,message:"",header:"Se entrego el alimento?",accept:()=>{t.statusOrderId=4,this._serviceOrder.updateItem(t.id,t).subscribe({next:r=>{this.hub.sendOrder(t)},error:r=>console.error(r)})}})}};o.\u0275fac=function(t){return new(t||o)(p(q),p(R),p(pe),p(ge),p(ue),p(me),p(de),p(fe))},o.\u0275cmp=H({type:o,selectors:[["app-attendace"]],features:[J([q,R])],decls:13,vars:5,consts:[["dv",""],["cd",""],[1,"grid"],[1,"col-10","col-offset-1"],[3,"header"],["class","formgroup-inline",4,"ngIf"],["emptyMessage","Sin ordenes en proceso",3,"value"],["pTemplate","list"],["pTemplate","headless"],[1,"formgroup-inline"],[1,"field","col-12","md:col-12","lg:col-9"],["placeholder","Buscar alimento(s) o bebida(s)","optionLabel","name",3,"ngModelChange","onFocus","completeMethod","onSelect","inputStyle","ngModel","suggestions","dropdown"],["pTemplate","item"],[1,"field","col-12","md:col-12","lg:col-2"],["placeholder","Cantidad","buttonLayout","horizontal","spinnerMode","horizontal","incrementButtonIcon","pi pi-plus","decrementButtonIcon","pi pi-minus",3,"ngModelChange","inputStyle","ngModel","showButtons","step","min","max"],[1,"col"],[1,"col-fixed"],["rows","1","cols","30","pInputTextarea","","placeholder","Complementos u/o Observaci\xF3n",3,"ngModelChange","autoResize","ngModel"],["pButton","","pRipple","","icon","pi pi-plus","label","Agregar",3,"click"],["class","field col-12 md:col-12 lg:col-4",4,"ngIf"],[1,"field","col-12","md:col-12","lg:col-4"],["label","Asistencia","icon","pi pi-bell","severity","info",3,"click","raised","ngClass"],[1,"field","col-12","md:col-12","lg:col-3"],["label","Cuenta","icon","pi pi-check",3,"click","raised","ngClass"],["label","Menu","icon","pi pi-list",3,"raised"],[1,"grid","grid-nogutter"],["class","col-12",3,"ngClass",4,"ngFor","ngForOf"],[1,"col-12"],[1,"flex","flex-column","sm:flex-row","sm:align-items-center","p-3","gap-3","border-top-1"],[1,"flex","flex-column","md:flex-row","justify-content-between","md:align-items-center","flex-1","gap-1"],[1,"flex","flex-row","md:flex-column","justify-content-between","align-items-start","gap-1"],[1,"text-lg","font-medium","text-900","mt-1"],[1,"col-12",3,"ngClass"],[1,"grid",3,"ngClass"],["alt","dropdown icon","src","/assets/images/icon/ban.svg","style","width: 25px;",4,"ngIf"],["alt","dropdown icon","src","/assets/images/icon/process.svg","style","width: 25px;",4,"ngIf"],["alt","dropdown icon","src","/assets/images/icon/uniform.svg","style","width: 25px;",4,"ngIf"],["alt","dropdown icon","src","/assets/images/icon/delivery.svg","style","width: 25px;",4,"ngIf"],["alt","dropdown icon","src","/assets/images/icon/meal.svg","style","width: 25px;",4,"ngIf"],[1,"text-900","mt-1"],[1,"col-fixed","gap-1"],["class","col-fixed gap-1",4,"ngIf"],["alt","dropdown icon","src","/assets/images/icon/ban.svg",2,"width","25px"],["alt","dropdown icon","src","/assets/images/icon/process.svg",2,"width","25px"],["alt","dropdown icon","src","/assets/images/icon/uniform.svg",2,"width","25px"],["alt","dropdown icon","src","/assets/images/icon/delivery.svg",2,"width","25px"],["alt","dropdown icon","src","/assets/images/icon/meal.svg",2,"width","25px"],["icon","pi pi-check","severity","success",3,"onClick","disabled"],["icon","pi pi-ban","severity","danger",3,"onClick","disabled"],[1,"flex","flex-column","align-items-center","p-5","surface-overlay","border-round"],[1,"border-circle","bg-primary","inline-flex","justify-content-center","align-items-center","h-6rem","w-6rem"],[1,"pi","pi-question","text-5xl"],[1,"font-bold","text-2xl","block","mb-2","mt-4"],[1,"mb-0"],[1,"flex","align-items-center","gap-2","mt-4"],["pButton","","label","Si",1,"w-8rem",3,"click"],["pButton","","label","No",1,"p-button-outlined","w-8rem",3,"click"]],template:function(t,r){t&1&&(l(0,"div",2)(1,"div",3)(2,"p-card",4),h(3,Xe,6,18,"div",5)(4,Ye,6,8,"div",5)(5,Ke,6,15,"div",5),l(6,"p-dataView",6,0),h(8,st,10,4,"ng-template",7),c()()()(),v(9,"p-toast"),l(10,"p-confirmDialog",null,1),h(12,at,10,2,"ng-template",8),c()),t&2&&(s(2),Y("header",r.table==null?null:r.table.name),s(),a("ngIf",r.isLogin),s(),a("ngIf",r.isLogin),s(),a("ngIf",!r.isLogin),s(),a("value",r.items))},dependencies:[ee,te,ie,_e,he,ce,oe,se,k,we,Se,Fe,ye,qe,Ae,Ee,ne],styles:[".item-cancel[_ngcontent-%COMP%]{background-color:var(--highlight-bg)!important;color:var(--surface-c)!important;text-decoration:line-through;text-decoration-color:#000!important}"]});let n=o;return n})();var Ne=(()=>{let o=class o{};o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=w({type:o}),o.\u0275inj=I({imports:[D.forChild([{path:"",component:Be}]),D]});let n=o;return n})();var Xt=(()=>{let o=class o{};o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=w({type:o}),o.\u0275inj=I({imports:[F,Ne,ve,xe,be,ae,Ce,Me,Te,ke,Ie,Re,Oe,Ve]});let n=o;return n})();export{Xt as AttendaceModule};
